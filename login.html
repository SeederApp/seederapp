<!DOCTYPE html>
<div data-bb-type="screen" style="background-color: #181818" data-bb-effect="fade" data-bb-scroll-effect="off">
	<script src="js/sha1.js"></script>
	<script type="text/javascript">
	function sendRequest(url, callback) {
		var xmlhttp;
		if (window.XMLHttpRequest)
		{// code for IE7+, Firefox, Chrome, Opera, Safari
		  xmlhttp=new XMLHttpRequest();
		}
		xmlhttp.onreadystatechange=function(){
		  if (xmlhttp.readyState==4 && xmlhttp.status==200)
			{
				if (xmlhttp.responseText == "" || JSON.parse(xmlhttp.responseText) == "") {
					document.getElementById("message").innerHTML = "Incorrect email or password";
					document.getElementById('indicator').style.visibility="hidden";
					document.getElementById('indicator').style.display="none";
				}
				else{
					callback(JSON.parse(xmlhttp.responseText));}
			}
		}
		xmlhttp.open("GET",url,true);
		xmlhttp.send();
	}
	function registerUser() {
	
	}
	function authenticateUser () {
		document.getElementById('indicator').style.visibility="visible";
		document.getElementById('indicator').style.display="block";
		document.getElementById("message").innerHTML = "";
		password = document.getElementById("password").value;
		email = document.getElementById("email").value;
		sendRequest("http://seederserver.aws.af.cm/index.php?users&command=getSaltByEmail&values[]=" +email, function (data){
			salt = data[0][0][0];
			hash = Sha1.hash(password + salt);
			url = "http://seederserver.aws.af.cm/index.php?users&command=login&values[]=" +email +"&hash=" +hash;
			sendRequest(url, function(data){
				 bb.pushScreen('all.html', 'allIdeas');
			});
		});
	}
	</script> 
	<div data-bb-type="round-panel" width="100%"> 
		<div style="background-image:url('images/seeder.png'); background-repeat: no-repeat; background-position: bottom; height: 25%; margin-bottom: 20px"></div>
			<div style="margin-bottom:30px;">
				<input id="email" type="text" placeholder="Email"/>
				<input id="password" type="password" placeholder="Password"/>
			</div>
			<div>
				<div data-bb-type="button" data-bb-style="stretch" style="margin:0 0 20px 0; background-color: blue" onclick="authenticateUser()">Login</div>
				<div data-bb-type="button" data-bb-style="stretch" style="margin:0;" onclick="registerUser()">Register</div>
				<div id = "indicator" data-bb-type="activity-indicator" data-bb-size="large" style="visibility: hidden; text-align: center; margin: 0 auto"></div>
				<div id="message" style="color: white"></div>
			</div>
	</div>
</div>